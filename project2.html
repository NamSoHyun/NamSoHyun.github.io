<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="project2style.css">
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
    <title>소리곳간</title>
</head>
<style>
    /* Swiper 기본 버튼 아이콘 제거 */
    .swiper-button-next::after,
    .swiper-button-prev::after {
    content: ''; 
    }
    /* 오른쪽 버튼 (▶) */
    .swiper-button-next {
    width: 0;
    height: 0;
    border-top: 10px solid transparent;
    border-bottom: 10px solid transparent;
    border-left: 15px solid #fff; /* 흰색 삼각형 */
    filter: drop-shadow(0 0 2px rgb(255, 255, 255))
          drop-shadow(0 0 5px rgba(255, 255, 255, 0.367))
          drop-shadow(0 0 8px rgba(255, 255, 255, 0.201));
    }
    /* 왼쪽 버튼 (◀) */
    .swiper-button-prev {
    width: 0;
    height: 0;
    border-top: 10px solid transparent;
    border-bottom: 10px solid transparent;
    border-right: 15px solid #fff;
    filter: drop-shadow(0 0 2px rgb(255, 255, 255))
          drop-shadow(0 0 5px rgba(255, 255, 255, 0.367))
          drop-shadow(0 0 8px rgba(255, 255, 255, 0.201));
    }
    .swiper-pagination-bullet {
    background: #fff !important; 
    }
    .swiper-pagination-bullet-active {
    background: #ffffff !important; 
    filter: drop-shadow(0 0 2px rgb(255, 255, 255))
          drop-shadow(0 0 5px rgba(255, 255, 255, 0.367))
          drop-shadow(0 0 8px rgba(255, 255, 255, 0.201));
    }
</style>
<body>
    <div class="title-circle">●</div>
    <h2>소리곳간</h2>
    <img src="img/logo_white.png" style="max-width: 100px; margin: auto; margin-bottom: 2em;">

    <div class="project-container">
        <!-- 왼쪽 정보 -->
        <div class="info-box">
        <h3>프로젝트 기여도</h3>
        <p>70%</p>
        <h3>작업인원</h3>
        <p>3명</p>
        <h3>작업기간</h3>
        <p>4 WEEKS</p>
        </div>
        
        <!-- 오른쪽 설명 -->
        <div>
        <div class="overview">
            <div class="overview-title">프로젝트 개요</div>
            본 프로젝트는 소리곳간 음원 스트리밍 서비스의 인프라 전반을 대상으로 
            보안 아키텍처를 설계·구축한 것입니다. 웹 서버, API 서버, DB 서버, 
            NFS 파일 서버, 로그 수집 서버 등 주요 구성 요소를 연동하고, 
            WAF·IDS/IPS와 같은 보안 장비를 적용하여 SQL Injection, XSS, HTTP Flood 등
             다양한 공격 시나리오에 대한 탐지 및 대응 체계를 마련하였습니다.</div>
        <!-- 태그 -->
        <div class="tags">
            <span class="tag">#ClamAV</span>
            <span class="tag">#Flask API</span>
            <span class="tag">#MariaDB</span>
            <span class="tag">#ModSecurity</span>
            <span class="tag">#Kali Linux</span>
            <span class="tag">#pfsense</span>
            <span class="tag">#Rockey Linux</span>
            <span class="tag">#Snort</span>
            <span class="tag">#Springboot</span>
            <span class="tag">#Splunk</span>
            <span class="tag">#XUbuntu</span>
        </div>
        </div>
    </div>

    <section class="project-method">
        <div class="project-method-title">공격 시나리오 기준</div>
        <div class="project-method-content">
            <p>
            본 프로젝트에 제시된 공격 시나리오는 <strong style="color: rgb(255, 145, 145);">
            「주요정보통신기반시설 기술적 취약점 분석·평가 방법 상세 가이드」</strong>에 수록된
            웹 공격 시나리오를 참고하여 정리하였으며 이를 기반으로 수행되었습니다.
            </p>
        </div>
    </section>

    <section class="project-summary">
        <div class="summary-box">
            <div style="display: flex; border: 1px solid #fff;">
                <div class="summary-number-num1">1</div>
                <div class="summary-number-title1">주요 역할</div>
            </div>
            <p>
            메인 서비스 운영 센터 (A센터) 구축 및 WAF·네트워크 방화벽 설정, 
            DNS·NFS 운영을 수행. Kali 기반 침투검증과 
            로그 수집·모니터링으로 취약점 검증 후 보고서 작성 담당.
            </p>
        </div>

        <div class="summary-box">
            <div style="display: flex; border: 1px solid #fff;">
                <div class="summary-number-num1">2</div>
                <div class="summary-number-title1">경험 및 배운 점</div>
            </div>
            <p>
             메인 서비스 운영 센터 (A센터) 구축과 WAF·네트워크 방화벽 설정 과정을 통해 
            인프라 보안 설계 및 운영 경험을 체득. 침투검증을 통해 취약점 
            검증·PoC 재현 능력을 강화하고 탐지·대응 절차를 습득.
            </p>
        </div>

        <div class="summary-box">
            <div style="display: flex; border: 1px solid #fff;">
                <div class="summary-number-num1">3</div>
                <div class="summary-number-title1">문제점 및 해결 과정</div>
            </div>
            <p>
            외부망 웹서버와 내부망 NFS·DB·API 서버 간 통신 시 방화벽 설정에 어려움 발생.  
            서비스 흐름을 분석해 최소 권한 포트만 허용하도록 방화벽 정책을 설계·적용하여 문제 해결.
            </p>
        </div>
    </section>

    <section class="project-result" style="margin-top: 5em;">
        <div class="title-circle1">●</div>
        <h3 class="result-title" style="margin-bottom: 2em;">프로젝트 결과물</h3>

        <!-- 서비스 화면 스크린샷 -->
        <div class="result-item">
            <div class="result-desc">
                <h4>
                    <span class="circle"></span>
                    웹 서비스 UI
                </h4>
                <p>
                    회원가입/로그인, 음악 검색, 재생, 다운로드 기능 구현 
                    실제 음원 파일은 NFS 서버를 통해 제공
                </p>
            </div>
            <section class="report-view">
                <div class="swiper mySwiper">
                    <div class="swiper-wrapper">
                    <div class="swiper-slide"><img src="img/sorigotganmain.png"></div>
                    <div class="swiper-slide"><img src="img/sorigotganmain2.png"></div>
                    <div class="swiper-slide"><img src="img/sorigotganmain3.png"></div>
                    <div class="swiper-slide"><img src="img/sorigotganmain1.png"></div>
                    </div>
                    <!-- 네비게이션 버튼 -->
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
                    <!-- 페이지 표시 -->
                    <div class="swiper-pagination"></div>
                </div>
            </section>
        </div>

        <!-- 아키텍처 다이어그램 -->
        <div class="result-item" style="margin-top: 10vh;">
            <div class="result-desc">
                <h4>
                    <span class="circle"></span>
                    아키텍처 설계
                </h4>
                <p>
                    메인 서비스 운영 센터 (A센터) / 로그 관리 센터 (B센터)
                </p>
            </div>
            <div class="img-wrap">
                <img id="architecture-thumb" src="img/architecture.png" alt="아키텍처 다이어그램" class="result-img" />
            </div>
            <!-- 라이트박스 / 뷰어 마크업 -->
            <div id="imgViewer" class="img-viewer" aria-hidden="true" role="dialog" aria-label="Image viewer">
                <div class="iv-backdrop" id="ivBackdrop"></div>
                <div class="iv-toolbar">
                    <button id="ivZoomIn" title="확대">＋</button>
                    <button id="ivZoomOut" title="축소">−</button>
                    <button id="ivReset" title="원래대로">⟲</button>
                    <button id="ivClose" title="닫기">✕</button>
                </div>
                <div class="iv-stage" id="ivStage">
                    <!-- 이미지 요소는 JS에서 복사해서 넣음 -->
                </div>
                <div class="iv-hint">휠/핀치로 확대 · 드래그로 이동 · ESC로 닫기</div>
            </div>
            <section class="project-method">
                <div class="project-method-title">A센터</div>
                <div class="project-method-content">
                <ul>
                    <li>WEB·WAS·DB 서버를 분리해 성능과 보안 강화</li>
                    <li>네트워크는 <strong style="color: rgb(255, 145, 145);">Intranet / DMZ / SO</strong> 3계층 구성</li>
                    <li>Intranet : 내부 전용, 안정성 보장</li>
                    <li>DMZ : 외부 접근 격리, 위협 차단</li>
                    <li>SO(Security Onion) : 보안 모니터링·트래픽 분석</li>
                </ul>
                </div>
            </section>
            <section class="project-method">
                <div class="project-method-title">B센터</div>
                <div class="project-method-content">
                <ul>
                    <li>로그 수집 및 취약점 관리로 보안 이벤트를 중앙에서 관리</li>
                    <li>외부 사용자 접속 제어 및 안전한 접근 통로 확보</li>
                    <li><strong style="color: rgb(255, 145, 145);">Logging / Dev-oper / Office</strong>의 NIC로 구성</li>
                    <li>Logging: 로그·보안 데이터를 안전하게 저장하고 네트워크를 모니터링해 위협을 탐지</li>
                    <li>Dev-oper (Admin): 네트워크 중앙 관리 영역으로 A센터 자원 접근 권한 보유, 외부와 연결되는 유일한 통로</li>
                    <li>Office: 외부 사용자는 Dev-oper를 통해 내부에 접근하며 안전한 외부 접속을 제공</li>
                </ul>
                </div>
            </section>
        </div>
    </section>

    <a href="index.html#project" class="back">포트폴리오로 돌아가기</a>

    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script>
        var swiper = new Swiper(".mySwiper", {
            navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
            },
            pagination: {
            el: ".swiper-pagination",
            clickable: true,
            },
            keyboard: true,   // 키보드 화살표로 넘기기 가능
        });
    </script>
    <script>
        (function(){
        const thumb = document.getElementById('architecture-thumb');
        const viewer = document.getElementById('imgViewer');
        const stage = document.getElementById('ivStage');
        const backdrop = document.getElementById('ivBackdrop');
        const btnZoomIn = document.getElementById('ivZoomIn');
        const btnZoomOut = document.getElementById('ivZoomOut');
        const btnReset = document.getElementById('ivReset');
        const btnClose = document.getElementById('ivClose');

        if(!thumb || !viewer) return;

        // 복제할 이미지 (원본의 src/alt 사용)
        const img = new Image();
        img.src = thumb.src;
        img.alt = thumb.alt || '';
        img.draggable = false;
        img.style.transformOrigin = 'center center';
        stage.appendChild(img);

        // 상태 변수
        let scale = 1;
        let minScale = 0.5;
        let maxScale = 6;
        let translate = {x:0, y:0};
        let isDragging = false;
        let dragStart = {x:0, y:0};
        let lastTouchDist = null;
        let lastTouchMid = null;

        // 초기화
        function resetTransform() {
            scale = 1;
            translate = {x:0, y:0};
            updateTransform();
        }

        function updateTransform() {
            img.style.transform = `translate(${translate.x}px, ${translate.y}px) scale(${scale})`;
        }

        // 열기
        function openViewer() {
            viewer.classList.add('open');
            viewer.setAttribute('aria-hidden','false');
            // 초기화 뷰 맞춤: 이미지가 큰 경우 보이도록 조정
            resetTransform();
            // 포커스 접근성
            btnClose.focus();
        }

        // 닫기
        function closeViewer() {
            viewer.classList.remove('open');
            viewer.setAttribute('aria-hidden','true');
        }

        // 휠 줌 (데스크탑)
        function onWheel(e) {
            e.preventDefault();
            // 휠 > 확대/축소 (빠르기 조절)
            const delta = - e.deltaY * 0.0015;
            zoomAt(e.clientX, e.clientY, delta);
        }

        // 윈도우 좌표 -> 이미지 내부 좌표 변환 (모달 중심 기준)
        function getStageRect() { return stage.getBoundingClientRect(); }

        function zoomAt(clientX, clientY, deltaScale) {
            const prevScale = scale;
            let next = scale * (1 + deltaScale);
            next = Math.min(Math.max(next, minScale), maxScale);
            const rect = getStageRect();
            // 이미지 좌표 기준으로 확대 중심점 조정 (팬 보정)
            const cx = clientX - rect.left - rect.width/2 - translate.x;
            const cy = clientY - rect.top - rect.height/2 - translate.y;
            // 변경된 translate: 새로운 스케일에서 동일한 화면 좌표를 유지
            translate.x -= (next/prevScale - 1) * cx;
            translate.y -= (next/prevScale - 1) * cy;
            scale = next;
            updateTransform();
        }

        // 버튼으로 확대/축소
        btnZoomIn.addEventListener('click', ()=> { zoomAt(window.innerWidth/2, window.innerHeight/2, 0.25); });
        btnZoomOut.addEventListener('click', ()=> { zoomAt(window.innerWidth/2, window.innerHeight/2, -0.2); });
        btnReset.addEventListener('click', resetTransform);
        btnClose.addEventListener('click', closeViewer);
        backdrop.addEventListener('click', closeViewer);

        // 이미지 클릭 -> 열기
        thumb.addEventListener('click', openViewer);

        // 드래그 시작
        img.addEventListener('mousedown', (e)=>{
            isDragging = true;
            img.classList.add('dragging');
            dragStart = { x: e.clientX, y: e.clientY };
        });
        window.addEventListener('mousemove', (e)=>{
            if(!isDragging) return;
            const dx = e.clientX - dragStart.x;
            const dy = e.clientY - dragStart.y;
            dragStart = { x: e.clientX, y: e.clientY };
            translate.x += dx;
            translate.y += dy;
            updateTransform();
        });
        window.addEventListener('mouseup', ()=>{
            if(isDragging) {
            isDragging = false;
            img.classList.remove('dragging');
            }
        });

        // 터치: 드래그(1finger) & 핀치(2finger)
        img.addEventListener('touchstart', (e)=>{
            if(e.touches.length === 1) {
            isDragging = true;
            dragStart = { x: e.touches[0].clientX, y: e.touches[0].clientY };
            } else if(e.touches.length === 2) {
            isDragging = false;
            lastTouchDist = getDistance(e.touches[0], e.touches[1]);
            lastTouchMid = getMidpoint(e.touches[0], e.touches[1]);
            }
        }, {passive:false});

        img.addEventListener('touchmove', (e)=>{
            e.preventDefault();
            if(e.touches.length === 1 && isDragging) {
            const dx = e.touches[0].clientX - dragStart.x;
            const dy = e.touches[0].clientY - dragStart.y;
            dragStart = { x: e.touches[0].clientX, y: e.touches[0].clientY };
            translate.x += dx;
            translate.y += dy;
            updateTransform();
            } else if(e.touches.length === 2) {
            const dist = getDistance(e.touches[0], e.touches[1]);
            const mid = getMidpoint(e.touches[0], e.touches[1]);
            if(lastTouchDist) {
                const ratio = dist / lastTouchDist;
                const deltaScale = ratio - 1;
                zoomAt(mid.x, mid.y, deltaScale); // 중심으로 확대
            }
            lastTouchDist = dist;
            lastTouchMid = mid;
            }
        }, {passive:false});

        img.addEventListener('touchend', (e)=>{
            if(e.touches.length < 2) lastTouchDist = null;
            if(e.touches.length === 0) isDragging = false;
        });

        function getDistance(p1, p2) {
            const dx = p1.clientX - p2.clientX;
            const dy = p1.clientY - p2.clientY;
            return Math.hypot(dx, dy);
        }
        function getMidpoint(p1, p2) {
            return { x: (p1.clientX + p2.clientX)/2, y: (p1.clientY + p2.clientY)/2 };
        }

        // 휠 이벤트 (이미지 위 또는 스테이지)
        stage.addEventListener('wheel', onWheel, {passive:false});

        // 키보드: ESC 닫기, +/- 확대축소
        window.addEventListener('keydown', (e)=>{
            if(!viewer.classList.contains('open')) return;
            if(e.key === 'Escape') closeViewer();
            if(e.key === '+' || e.key === '=') zoomAt(window.innerWidth/2, window.innerHeight/2, 0.15);
            if(e.key === '-') zoomAt(window.innerWidth/2, window.innerHeight/2, -0.15);
        });

        // 이미지 로드 후 초기화 (이미지가 크면 중심 정렬을 위해)
        img.addEventListener('load', ()=> {
            resetTransform();
        });

        // 화면 리사이즈 시 (이미지 보정)
        window.addEventListener('resize', ()=> {
            // 뷰포트 바뀌면 이동이 지나치게 되면 보정 필요 시 추가 구현 가능
        });

        })();
    </script>
</body>
</html>
